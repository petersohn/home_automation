sudo: required
dist: trusty
services: postgresql
addons:
    postgresql:
        9.4

language: python
python:
    - 3.4
    - 3.5

before_install:
    - sudo apt-get update -qq

install:
    - sudo apt-get install -qq lighttpd
    - pip install django psycopg2 gitpython
    - pip list
    - echo $PYTHONPATH
    - echo $PATH
    - echo $LD_LIBRARY_PATH

script:
    - python3 ./server/home_automation/manage.py test home
    - ./deploy/create_deployment.py --type=install --system=upstart
    - mkdir -p custom/install
    - cd custom/install
    - tar -xf ../../home_automation.tar.gz
    - sudo bash -x ./home_automation/install.sh

notifications:
    email:
        - kangirigungi@gmail.com
    on_success: change
    on_failure: always

